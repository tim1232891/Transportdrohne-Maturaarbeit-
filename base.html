<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title or "KUE Transportdrohne" }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="icon" href="{{ url_for('static', filename='assets/logo.svg') }}">

  <style>
    /* Layout */
    .nav{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 0}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{width:28px;height:28px}

    .nav-right{display:flex;align-items:center;gap:12px}
    .menu-left{display:flex;gap:10px;align-items:center;flex-wrap:nowrap}

    /* Buttons */
    .nav-btn{
      display:inline-flex;align-items:center;justify-content:center;
      height:38px;padding:0 14px;border-radius:10px;white-space:nowrap;
      font-weight:600;font-size:14px;line-height:1;text-decoration:none;
      box-sizing:border-box;border:1px solid #e5e7eb;background:#fff;color:#0f172a;
      box-shadow:0 1px 0 rgba(15,23,42,.04);
      transition:background .15s ease,border-color .15s ease,box-shadow .15s ease,transform .05s ease;
    }
    .nav-btn:hover{background:#f8fafc;border-color:#dbe3ea}
    .nav-btn:active{transform:translateY(1px)}
    /* Aktiv: nur Rand blau, kein blauer Hintergrund */
    .nav-btn.active{border-color:#0ea5e9;background:#fff}

    /* Hamburger */
    .menu-more{position:relative}
    .menu-btn{
      width:42px;height:38px;border:0;border-radius:10px;background:#0f172a;
      display:inline-flex;align-items:center;justify-content:center;cursor:pointer;
      box-shadow:0 1px 0 rgba(0,0,0,.15);transition:background .15s ease,transform .05s ease;
    }
    .menu-btn:hover{background:#111827}
    .menu-btn:active{transform:translateY(1px)}
    .menu-icon{width:18px;height:14px;position:relative}
    .menu-icon .bar{
      position:absolute;left:0;width:100%;height:2px;background:#fff;border-radius:2px;
      transition:transform .2s ease,opacity .2s ease,top .2s ease;
    }
    .menu-icon .bar:nth-child(1){top:0}
    .menu-icon .bar:nth-child(2){top:6px}
    .menu-icon .bar:nth-child(3){top:12px}
    .menu-btn.is-open .bar:nth-child(1){top:6px;transform:rotate(45deg)}
    .menu-btn.is-open .bar:nth-child(2){opacity:0}
    .menu-btn.is-open .bar:nth-child(3){top:6px;transform:rotate(-45deg)}

    /* Dropdown */
    .more-panel{
      position:absolute;right:0;top:46px;min-width:220px;background:#fff;border:1px solid #e5e7eb;border-radius:12px;
      box-shadow:0 10px 30px rgba(15,23,42,.08);padding:6px;display:none;z-index:50
    }
    .more-panel a{
      display:block;padding:10px 12px;border-radius:8px;text-decoration:none;color:#0f172a;font-weight:600;font-size:14px
    }
    .more-panel a:hover{background:#f8fafc}
    .more-panel a.active{background:#fff;border:1px solid #0ea5e9}

    /* Fokus */
    .nav-btn:focus-visible,.menu-btn:focus-visible{outline:none;box-shadow:0 0 0 2px #cbd5e1 inset}
    @media (prefers-reduced-motion:reduce){
      .menu-icon .bar,.nav-btn,.menu-btn{transition:none}
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- Navigation -->
    <nav class="nav">
      <div class="brand">
        <img src="{{ url_for('static', filename='assets/logo.svg') }}" alt="Logo">
        <span>KUE Transportdrohne</span>
      </div>

      <div class="nav-right">
        <!-- sichtbare Hauptlinks -->
        <div class="menu-left">
          <a href="{{ url_for('home') }}" class="nav-btn {{ 'active' if active=='home' else '' }}">Start</a>
          <a href="{{ url_for('order') }}" class="nav-btn {{ 'active' if active=='order' else '' }}">Adresse</a>
          <a href="{{ url_for('extraorder') }}" class="nav-btn {{ 'active' if active=='extraorder' else '' }}">Karte</a>
          <a href="{{ url_for('bulk_upload') }}" class="nav-btn {{ 'active' if active=='bulk_upload' else '' }}">Datei-Import</a>
        </div>

        <!-- Hamburger + weitere Links -->
        <div class="menu-more">
          <button class="menu-btn" aria-label="Weitere Menüpunkte" aria-expanded="false" aria-controls="morePanel">
            <div class="menu-icon" aria-hidden="true">
              <span class="bar"></span>
              <span class="bar"></span>
              <span class="bar"></span>
            </div>
          </button>
          <div id="morePanel" class="more-panel" role="menu" aria-hidden="true">
            <a href="{{ url_for('about') }}" class="{{ 'active' if active=='about' else '' }}" role="menuitem">Über uns</a>
            <a href="{{ url_for('imprint') }}" class="{{ 'active' if active=='imprint' else '' }}" role="menuitem">Impressum</a>
          </div>
        </div>
      </div>
    </nav>

    {% block content %}{% endblock %}

    <footer>© 2025 KUE Transportdrohne – Alle Rechte vorbehalten.</footer>
  </div>

  <script>
    const btn = document.querySelector('.menu-btn');
    const panel = document.getElementById('morePanel');

    function closePanel(){
      panel.style.display='none';
      btn.classList.remove('is-open');
      btn.setAttribute('aria-expanded','false');
      panel.setAttribute('aria-hidden','true');
      document.removeEventListener('click', onOutside);
      document.removeEventListener('keydown', onEsc);
    }
    function onOutside(e){
      if (!panel.contains(e.target) && !btn.contains(e.target)) closePanel();
    }
    function onEsc(e){
      if (e.key === 'Escape') closePanel();
    }
    btn.addEventListener('click', (e)=>{
      e.stopPropagation();
      const open = panel.style.display==='block';
      if (open){ closePanel(); return; }
      panel.style.display='block';
      btn.classList.add('is-open');
      btn.setAttribute('aria-expanded','true');
      panel.setAttribute('aria-hidden','false');
      setTimeout(()=>{ document.addEventListener('click', onOutside); document.addEventListener('keydown', onEsc); },0);
    });
  </script>
</body>
</html>
